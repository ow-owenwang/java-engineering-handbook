# 快速入门

根据 maven-archetype-webapp 模板创建一个 Maven 项目。

在 pom.xml 中导入坐标：

```xml
<properties>
  <spring.version>5.2.14.RELEASE</spring.version>
</properties>

<!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-context</artifactId>
  <version>${spring.version}</version>
</dependency>

<!-- https://mvnrepository.com/artifact/org.springframework/spring-web -->
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-web</artifactId>
  <version>${spring.version}</version>
</dependency>

<!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc -->
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-webmvc</artifactId>
  <version>${spring.version}</version>
</dependency>

<!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api -->
<dependency>
  <groupId>javax.servlet</groupId>
  <artifactId>javax.servlet-api</artifactId>
  <version>4.0.1</version>
  <scope>provided</scope>
</dependency>

<!-- https://mvnrepository.com/artifact/javax.servlet.jsp/javax.servlet.jsp-api -->
<dependency>
  <groupId>javax.servlet.jsp</groupId>
  <artifactId>javax.servlet.jsp-api</artifactId>
  <version>2.3.3</version>
  <scope>provided</scope>
</dependency>

<!-- https://mvnrepository.com/artifact/junit/junit -->
<dependency>
  <groupId>junit</groupId>
  <artifactId>junit</artifactId>
  <version>4.13.2</version>
  <scope>test</scope>
</dependency>
```

貌似只导入如下坐标就可以：

```xml
<!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context</artifactId>
    <version>${spring.version}</version>
</dependency>

<!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>${spring.version}</version>
</dependency>
```

在 web.xml 中配置核心控制器：

```xml
<!--SpringMVC 核心控制器-->
<servlet>
  <servlet-name>dispatcherServlet</servlet-name>
  <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
  <!--配置初始化参数，用来读取配置文件创建 Spring 容器-->
  <init-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:springmvc.xml</param-value>
  </init-param>
  <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
  <servlet-name>dispatcherServlet</servlet-name>
  <url-pattern>/</url-pattern>
</servlet-mapping>
```

创建 springmvc.xml 文件，并进行配置：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans.xsd
         http://www.springframework.org/schema/mvc
         http://www.springframework.org/schema/mvc/spring-mvc.xsd
         http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context.xsd">
  <!--配置 Spring 创建容器时要扫描的包-->
  <context:component-scan base-package="org.example"/>
  <!--配置视图解析器-->
  <bean id="viewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/pages/"/>
    <property name="suffix" value=".jsp"/>
  </bean>
</beans>
```

创建 index.jsp 文件：

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" isELIgnored="false" %>
<html>
<head>
    <title>Title</title>
</head>
<body>
<h1>Spring Quickstart</h1>
<a href="${pageContext.request.contextPath}/hello">入门</a>
</body>
</html>
```

创建 HelloController 控制器类：

```java
@Controller
public class HelloController {
    @RequestMapping(path = "/hello")
    public String sayHello() {
        System.out.println("Hello");
        return "success";
    }
}
```

创建 WEB-INF/pages/success.jsp 文件：

<%@ page contentType="text/html;charset=UTF-8" language="java" %><html><head>    <title>Title</title></head><body><h1>成功页面</h1></body></html>

到此，一个最简单的入门案例就完成了，最后启动 Tomcat 进行测试。此时的目录结构如下：

![](assets/document_image_rId4.png)

以上入门案例的执行流程：

启动 Tomcat，因为配置有 <load-on-startup>1</load-on-startup>，org.springframework.web.servlet.DispatcherServlet 对象会立即被创建，并且读取 springmvc.xml 文件。

根据配置文件 springmvc.xml，Spring 对 org/example 进行扫描，创建 HelloController 对象。

点击 index.jsp 中的链接，请求到达 DispatcherServlet 核心控制器，然后根据 @RequestMapping 注解，执行对应的方法。方法执行成功后，返回字符串 success。

根据方法返回值 success 以及视图解析器的配置，找到 WEB-INF/pages/success.jsp 文件。

Tomcat 对 success.jsp 进行渲染并返回。

DispatcherServlet 类实际也是一个 Servlet，它可以拦截所有请求。

<mvc:default-servlet-handler />：SpringMVC 不对静态资源进行处理。如果想访问到图片、css 文件等静态资源需要进行配置。

<mvc:annotation-driven />：

经过测试，<mvc:annotation-driven /> 默认是开启的，也就是说默认情况下可以正常使用 SpringMVC 注解。然而如果开启 <mvc:default-servlet-handler /> 的话，SpringMVC 注解会失效，需要手动开启 <mvc:annotation-driven />。所以最好两个都开启。

<mvc:view-controller path="/" view-name="redirect:/hello/" />

DispatcherServletHandlerMapping

Handler

HandlerAdapter

View Resolver

View

<mvc:annotation-driven>